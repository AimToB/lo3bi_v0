generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

enum Role {
  USER
  ADMIN
}

model User {
  id       String @id @default(uuid())
  fullName String
  email    String @unique
  password String
  role     Role   @default(USER)

  reservationsCreated Reservation[]            @relation("CreatedBy")
  participations      ReservationParticipant[]

  createdAt DateTime   @default(now())
  updatedAt DateTime   @updatedAt
  blogPosts BlogPost[]
}

model Reservation {
  id String @id @default(uuid())

  startAt  DateTime
  endAt    DateTime
  capacity Int

  createdBy   User   @relation("CreatedBy", fields: [createdById], references: [id])
  createdById String

  participants ReservationParticipant[]

  status String @default("ACTIVE")

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@index([startAt, endAt])
}

model ReservationParticipant {
  id     String @id @default(uuid())
  user   User   @relation(fields: [userId], references: [id])
  userId String

  reservation   Reservation @relation(fields: [reservationId], references: [id])
  reservationId String

  joinedAt DateTime @default(now())

  @@unique([userId, reservationId])
}

model BlogPost {
  id      String @id @default(uuid())
  title   String
  slug    String @unique
  content String

  published Boolean @default(false)

  author   User?   @relation(fields: [authorId], references: [id])
  authorId String?

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Product {
  id          String  @id @default(uuid())
  name        String
  description String
  price       Int // store in smallest currency unit (e.g. cents)
  isActive    Boolean @default(true)

  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}
